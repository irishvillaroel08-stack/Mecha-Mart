async function render(){const q=parseQuery();const products=await loadProducts();const p=products.find(x=>x.id===q.id);if(!p){document.getElementById('content').innerHTML='<p>Product not found.</p>';return;}document.title=p.title+' â€” Mecha Mart';document.querySelector('[data-breadcrumb]').textContent=p.title;const main=document.getElementById('main-image');const thumbs=document.getElementById('thumbs');function show(i=0){main.src=p.images[i]||p.thumbnail}p.images.forEach((src,i)=>{const im=document.createElement('img');im.src=src;im.alt=p.title+' '+(i+1);im.addEventListener('click',()=>show(i));thumbs.appendChild(im);});show(0);document.getElementById('title').textContent=p.title;document.getElementById('brand').textContent=p.brand;document.getElementById('price').textContent=currency(p.price,p.currency);const old=document.getElementById('old');if(p.compare_at_price){old.textContent=currency(p.compare_at_price,p.currency)}else{old.remove()}document.getElementById('desc').textContent=p.description;document.getElementById('sku').textContent=p.sku;document.getElementById('stock').textContent=p.stock>0?`${p.stock} in stock`:'Out of stock';const qty=document.getElementById('qty');document.getElementById('add').addEventListener('click',()=>{if(p.stock<=0)return toast('Out of stock');addToCart({id:p.id,title:p.title,price:p.price,thumbnail:p.thumbnail,currency:p.currency,qty:parseInt(qty.value||'1',10)});});}render();
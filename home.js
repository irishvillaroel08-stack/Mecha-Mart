async function render(){const grid=document.getElementById('grid');const search=document.getElementById('search');const category=document.getElementById('category');const brand=document.getElementById('brand');const sort=document.getElementById('sort');const products=await loadProducts();const cats=[...new Set(products.map(p=>p.category))];const brands=[...new Set(products.map(p=>p.brand))];cats.forEach(c=>category.append(new Option(c,c)));brands.forEach(b=>brand.append(new Option(b,b)));function apply(){const q=search.value.trim().toLowerCase();const c=category.value;const b=brand.value;let list=products.filter(p=>{const mQ=!q||(p.title.toLowerCase().includes(q)||p.brand.toLowerCase().includes(q)||p.tags.join(' ').toLowerCase().includes(q));const mC=!c||p.category===c;const mB=!b||p.brand===b;return mQ&&mC&&mB;});if(sort.value==='price-asc')list.sort((a,b)=>a.price-b.price);if(sort.value==='price-desc')list.sort((a,b)=>b.price-a.price);if(sort.value==='title')list.sort((a,b)=>a.title.localeCompare(b.title));grid.innerHTML='';list.forEach(p=>{const el=document.createElement('a');el.href=`product.html?id=${encodeURIComponent(p.id)}`;el.className='card';el.innerHTML=`<div class='thumb'><img src='${p.thumbnail}' alt='${p.title}'></div><div class='body'><div class='kicker'>${p.brand} â€¢ ${p.category}</div><div class='title' style='font-weight:700'>${p.title}</div><div><span class='price'>${currency(p.price,p.currency)}</span>${p.compare_at_price?`<span class='old'>${currency(p.compare_at_price,p.currency)}</span>`:''}</div><button class='btn' style='margin-top:6px'>View</button></div>`;grid.appendChild(el);});}[search,category,brand,sort].forEach(el=>el.addEventListener('input',apply));apply()}render();